# 함수형 프로그래밍을 위한 핵심 개념

[패러다임의 변화](#프로그래밍-패러다임의-변화)

- [명령형 vs 선언형](#명령형-vs-선언형)

[함수형은 실용적인가요?](#함수형-패러다임은-쓸모가-없어요)

- [함수형 프로그램은?](#함수형-프로그래밍)
- [함수형 프로그래밍의 오류?](#함수형의-에러)

[함수형 프로그래밍의 핵심](#함수형-프로그래밍의-핵심)

- [분류?](#어떻게-분류해)
- [일급추상?](#일급추상)

[함수형 사고](#함수형-사고)

- [분리를 먼저](#분리를-먼저-해봅시다)
- [확장성을 고려해보자](#확장을-고려해보자)
- [확장성을 했다면?](#확장을-했다면)

[결론](#결론)

## 프로그래밍 패러다임의 변화

컴퓨터 공학의 발전은 당시 처했던 상황이나 철학에 영향을 많이 받는다. 왜냐하면 자연 법칙 보다는 인간이 만들어낸 규칙을 통해 동작하기 때문이다. 백퍼센트 맞는 말이 아닐 수 있지만 인간이 만들어낸 규칙이기 때문에 패러다임의 변화에 인간의 철학, 사고방식이 많이 닮아 있다.

함수형을 위해 모든 패러다임을 이해해야 하는 것은 아니지만.. 왜 함수형이라는 질문에 조금은 답이 될 것 같아 간략하게 찾아보았다.

<br/>

### 명령형 vs 선언형

`명령형 프로그래밍`은 프로그램의 상태를 변경하는 구문의 연산을 설명하는 패러다임이다.

```js
for (let i = 1; i <= 10; i++) {
  이러쿵저러쿵어쩌고저쩌고
  ...
}
```

비유를 들자면 모든 행동을 설명하는 패러다임이다.

최근에는 명령형 패러다임이 가독성이 떨어지고, 유지보수가 힘들기 때문에 선언형으로 코드를 작성하는 것이 좋다고 하지만. 컴퓨터는 명령형으로 코드를 읽어들인다.

때문에 명령형으로 복잡한 프로그램을 만들기 위해 당시 천재들의 뼈를 바쳐 근본이 되는 언어들을 만들었을 것이다. 포틀란, 코볼, 베이직, c, 모두 같은 시기에 나온 언어는 아니지만 기존에 있던 언어의 단점들을 부시면서 생긴 언어들이다.

명령형이 가장 먼저 만들어진 이유는 인간의 사고방식과 가장 가깝기 때문이라고 생각한다. 우리는 주어나 목적어를 생략해서 말하면 잘못된 의미를 전달할 가능성이 커지게 된다. 컴퓨터는 입력한 대로 이해할 수 있는 어쩌면 멍청한 존재이기 때문에 순서대로 정확하게 전달하기 위해 명령형이 발전할 수 밖에 없었다고 생각이 든다. 아닐수도..!

`선언형 프로그래밍`의 핵심은 `내포`다. 내포의 의미는 컴퓨터 공학에서 `추상화`라고 한다. 추상화를 내포라고 한 이유는 복잡한 세부정보를 가지고 겉으로는 그런 의미겠구나 추측할 수 있는 패러다임이라고 생각하기 때문이다.

```js
// 아까 위의 식을 선언형으로 바꾸면
arr.map(() => 어쩌고저쩌고());
```

어쩌고 저쩌고가 정확히 무슨일을 하는지 세부적인 동작을 모르지만 어쩌고저쩌고 함수를 통해 어떤 결과 값이 나온다 이해하는 패러다임이 `선언형 프로그래밍`이다.

지금 우리가 선언형 패러다임을 더 선호하는 이유는 너무 많지만.. 내가 겪하게 공감하는 부분은 모듈화, 캡슐화라고 생각한다.

세부 로직을 숨기는 방식은 한 곳을 위한 코드가 아니다. 재사용 가능성을 끌어올린다. 심지어 전체를 파악하는 시간을 확 줄여준다. 마치 요약본을 보는 기분을 느낄 수 있게 해준다.

뿐만 아니라 추상화란 사고는 컴퓨터가 동작하는데 매우 중요한 개념이기 때문에 꼭 컴퓨팅적 사고를 익히자!!

외에도 다양한 패러다임이 있지만 일단 가장 큰 방향은 이 두가지다. 객체지향 프로그래밍도 엄청난 사건이지만 `객체지향의 사실과 오해`에서 다루고 싶다.

<br/>

## 함수형 패러다임은 쓸모가 없어요?

함수형 패러다임은 학술 연구에서 많이 쓰였다. 때문에 실용성에 대한 이야기가 많이 나왔는데 책에서 함수형 프로그래밍은 실용적이라는 주장은 이렇다!

### 함수형 프로그래밍

함수형 프로그래밍의 정의는 아래와 같다.

1. 수학 함수를 사용하고, 부수효과를 피하는 것이 특징.
2. 부수 효과 없이 순수 함수를 사용하는 프로그래밍 스타일

오 그렇지.. 사전에도 이렇게 나와있고, 의미는 정확하다. 하지만 함수형의 의미가 실제 프러덕트에서 역설적임을 비판했습니다.

1. 부수 효과는 필요하다!
   부수효과가 없는 소프트웨어가 말이 되니?

2. 함수형 프로그래밍은 부수효과를 다루는 데 좋다.
   순수함수만을 이용해서 소프트웨어의 상태를 관리하는 것이 가능하니?? 함수형이 부수효과를 잘 다룰 수 있는데 왜??!!!

3. 함수형은 실용적이다!

<br/>

### 함수형의 에러

이메일을 보내는 서비스를 만든다고 가정하자!

함수형을 사용해서 이메일을 보내는 서비스를 만든다면... 이메일을 어떻게 보내지..?
이메일을 보내는 일은 순수함수가 아니다. 이는 부수효과다. 때문에 함수형 패러다임에 적합하지 않다. 그럼 함수형으로 만들지 말자..!

이게 올바른 추론일까..? 함수형의 정의만 생각한다면 합리적인 추론이다.. 부수효과를 피하고 순수함수를 사용하는 방식에는 맞지 않다.

하지만 함수형 프로그래밍은 부수효과를 잘 처리할 수 있는 방식..

지금부터 책에서 설명하는 핵심을 짚어보자!

<br/>

## 함수형 프로그래밍의 핵심

> 코드를 분류하고, 일급 추상을 고려해라

### 어떻게 분류해?

코드를 짜다보면 분리를 해야겠다는 생각이 드는 건 당연한 일입니다. 어떤 코드를 분리할까 고민하다 보면 답을 얻지 못할 때가 많았는데, `액션`, `계산`, `데이터`로 코드를 분류해보자.

액션은 부수효과가 발생하는 함수, 계산은 순수함수 데이터는 데이터 입니다.

때문에 액션은 호출하는 시점에 따라 다른 효과를 낼 수 있으므로 액션과 계산, 데이터는 분리 됩니다. 또한 액션과 계산은 실행이 되는 함수이지만 데이터는 실행되는 코드가 아닙니다.

---

액션 - 부르는 시점

- 시간이 지남에 따라 안전하게 상태를 바꿀 수 있는 방법
- 순서를 보장하는 방법
- 액션이 한 번만 실행되게 보장하는 방법

---

계산 - 입력값이 다르면 출력값이 다름, 입력값이 같으면 출력이 같음

- 정확성
- 수학적 지식
- 테스트

---

데이터 - 이벤트에 대한 사실을 기록

- 효율적인 접근
- 보관
- 발견

---

<br/>

### 일급추상?

자바스크립트를 생각해보면 `일급 객체`가 있다. 다양한 개념과 지식이 있지만 일급 추상을 이해하는 데 필요한 것은 함수를 파라미터로 넘기는 행위를 의미합니다.

이를 적절하게 관리하는 것이 함수형 프로그래밍에서 엄청나게 중요한 요소임을 기억하자!!

<br/>

## 함수형 사고!!

> 토니의 피자가게 예시를 통해 함수형 사고의 접근법에 대해 알아보자.

위에도 말했듯이 함수형 프로그래밍의 `핵심`은 `액션`, `계산`, `데이터`, `일급추상`이다.

### 분리를 먼저 해봅시다.

---

**액션**

- 반죽 펴기
- 피자 배달
- 재료 주문

---

**계산**

- 조리법으로 피자 만들기, 큰 사이즈 피자 만들기, 작은 사이즈 피자 만들기
- 쇼핑 목록 결정

---

**데이터**

- 영수증
- 조리법

---

### 확장을 고려해보자

서비스의 확장을 고려한다면 모두가 정답을 알고 있듯이 수정하기 편하게 소프트웨어를 설계해야 한다. 흔히 말하는 클린코드는 수정하기 좋은 설계를 의미하기도 한다.

수정하기 좋은 코드는 어떻게 설계하면 될까?

`계층형`이 좋은 해결법이 될 수 있다. `변경 가능성`에 따라 계층을 설계한다면? 자주 바뀌는 코드를 수정하기 쉽게 설계한다면? 우리가 원하는 확장성을 고려한 설계가 될 것이다.

자주 바뀌는 일은 `비즈니스 로직`이겠지요? 거의 바뀌지 않는 것은 해당 소프트웨어를 만든 `기술스택`과 같은 것들이 되겠죠. 그리고 피자가게에 관한 `도메인 규칙`, 예를 들면 조리법과 같은 것들은 가끔 변할 것입니다.

이를 계층적으로 설계한다면 비즈니스 로직을 수정하더라도 다른 부분에 영향을 거의 주지 않겠죠? 물론 기술스택을 바꾼다거나 도메인 규칙을 바꾸면 비즈니스 로직을 수정할 경우도 있겠지만 거의 변하지 않으니깐요ㅎ..

### 확장을 했다면

로봇을 추가해서 더 많이 빨리 피자를 만들려고 한다면 어떻게 할까요?

로봇이 각자 피자를 만들게 시킨다면 우리는 비효율을 직감합니다. 과거 산업들이 비약적으로 발전할 수 있었던 이유는 분업을 했기 때문입니다. 로봇도 분업을 '잘' 한다면 피자를 효율적으로 만들 것입니다.

하지만 `어떻게` 일을 분담할지 소프트웨어를 수정해야합니다.

대충 주문 접수가 이뤄지면 로봇 세대를 가지고 일을 나눴다고 가정했습니다.

로봇은 시킨대로 하기 때문에 정확한 순서를 고려하며 일을 진행하지 않습니다. 예를 들면 반죽 만들기와 반죽 펴기가 다른 로봇이 처리한다면 반죽을 만들기 전에 반죽 펴기를 진행하면? 정상적인 피자가 만들어지지 않을 것입니다.

그럼 순서를 맞춰야겠죠?

그렇습니다! 딱봐도 우리는 콜백를 이용해야겠지요. 책에서는 이를 `타임라인 커팅`이라고 합니다. 해당 동작이 끝나고 다음 동작을 실행해야 합니다. 그래야 로봇이 순서에 맞게 피자를 만드니까욘.

<br/>

## 결론

함수형 프로그래밍에서 기억해야 할 개념들은 `분리, 일급 추상, 그에 맞는 설계`
